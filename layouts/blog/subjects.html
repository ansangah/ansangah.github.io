<!-- 커스텀 뷰 2 -->
{{ define "main" }}
<main class="container mx-auto px-4 py-8 course-archive">
  <header class="mb-10 text-center">
    <h1 class="text-3xl font-extrabold tracking-tight text-gray-900 dark:text-white">{{ .Title }}</h1>
    {{ with .Content }}<div class="prose mt-4 mx-auto text-left max-w-2xl">{{ . }}</div>{{ end }}
  </header>

  {{ $pages := .RegularPages }}
  {{ $order := slice "3-2" "3-1" "2-2" "2-1" }}
  {{ $labels := dict "3-2" "3학년 2학기" "3-1" "3학년 1학기" "2-2" "2학년 2학기" "2-1" "2학년 1학기" }}

  {{ range $order }}
    {{ $semester := . }}
    {{ $semesterPages := where $pages "Params.semester" $semester }}
    {{ if gt (len $semesterPages) 0 }}
      <section class="course-semester mb-14">
        {{ with index $labels $semester }}
          <h2 class="mb-5 text-2xl font-semibold text-slate-800 dark:text-white">{{ . }}</h2>
        {{ end }}
        <div class="course-semester__grid">
          {{ range $semesterPages.ByDate.Reverse }}
            <article class="course-card rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-100 dark:bg-[#1f2a44] shadow-sm p-5 transition-all hover:shadow-lg hover:-translate-y-1">
              <div class="text-[0.75rem] font-semibold uppercase tracking-[0.32em] text-slate-500 dark:text-slate-200">
                <span class="course-card__date">{{ .Date.Format "2006-01-02" }}</span>
              </div>
              <h3 class="mt-2 text-lg font-semibold text-gray-900 dark:text-white">
                <a href="{{ .RelPermalink }}" class="hover:text-indigo-500 dark:hover:text-indigo-200 transition-colors">{{ .Title }}</a>
              </h3>
              {{ with .Summary }}
                <p class="mt-2 text-sm leading-6 text-slate-600 dark:text-slate-100">{{ . }}</p>
              {{ end }}
              {{ with .Params.course_topics }}
                <ul class="mt-4 flex flex-wrap gap-2">
                  {{ range . }}
                    <li class="rounded-full bg-slate-200 dark:bg-[#274061] px-3 py-1 text-xs font-medium text-slate-600 dark:text-slate-100">{{ . }}</li>
                  {{ end }}
                </ul>
              {{ end }}
            </article>
          {{ end }}
        </div>
      </section>
    {{ end }}
  {{ end }}

  {{ $catchall := where $pages "Params.semester" "==" nil }}
  {{ $unordered := where $pages "Params.semester" "not in" $order }}
  {{ $others := union $catchall $unordered }}
  {{ if gt (len $others) 0 }}
    <section class="course-semester mb-14">
      <h2 class="mb-5 text-2xl font-semibold text-slate-800 dark:text-white">학기 미분류</h2>
      <div class="course-semester__grid">
        {{ range $others.ByDate.Reverse }}
          <article class="course-card rounded-xl border border-slate-200 dark:border-slate-600 bg-slate-100 dark:bg-[#1f2a44] shadow-sm p-5 transition-all hover:shadow-lg hover:-translate-y-1">
            <div class="flex items-center gap-2 text-[0.75rem] font-semibold uppercase tracking-[0.32em] text-slate-500 dark:text-slate-200">
              <span class="course-card__date">{{ .Date.Format "2006-01-02" }}</span>
            </div>
            <h3 class="mt-2 text-lg font-semibold text-gray-900 dark:text-white">
              <a href="{{ .RelPermalink }}" class="hover:text-indigo-500 dark:hover:text-indigo-200 transition-colors">{{ .Title }}</a>
            </h3>
            {{ with .Summary }}
              <p class="mt-2 text-sm leading-6 text-slate-600 dark:text-slate-100">{{ . }}</p>
            {{ end }}
          </article>
        {{ end }}
      </div>
    </section>
  {{ end }}
</main>
{{ end }}
